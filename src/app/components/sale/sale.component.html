<div class="product-autocomplete">
  <mat-form-field appearance="fill" class="custom-input">
    <mat-label>Rechercher un produit</mat-label>
    <input type="text" placeholder="Rechercher un produit" aria-label="Product" matInput [formControl]="productControl" [matAutocomplete]="auto">
    <mat-autocomplete #auto="matAutocomplete">
      <mat-option *ngFor="let product of filteredProducts | async" [value]="product.label">
        {{ product.label }}
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>
  <button mat-raised-button color="primary" (click)="addProduct()">Ajouter</button>
</div>

<div class="content-command">
  <div class="table-product">
    <mat-table mat-table [dataSource]="dataSource">
      <!-- Displayed columns -->
      <ng-container matColumnDef="label">
        <mat-header-cell *matHeaderCellDef class="label-column">Libellé</mat-header-cell>
        <mat-cell *matCellDef="let row" class="label-column">{{getLabelProduct(row.productId)}}</mat-cell>
      </ng-container>

      <ng-container matColumnDef="quantity">
        <mat-header-cell *matHeaderCellDef class="quantity-column">Quantité</mat-header-cell>
        <mat-cell *matCellDef="let row" class="quantity-column">
          <ng-container>
            <input [(ngModel)]="row.quantiteVendu" placeholder="Quantité" (ngModelChange)="onQuantityChange(row)" size="3">
          </ng-container>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="unitPrice">
        <mat-header-cell *matHeaderCellDef class="unit-price-column">Prix unitaire (Franc CFA)</mat-header-cell>
        <mat-cell *matCellDef="let row" class="unit-price-column">{{getPublicPriceProduct(row.productId) | currencyXof}}</mat-cell>
      </ng-container>

      <ng-container matColumnDef="totalAmount">
        <mat-header-cell *matHeaderCellDef class="total-column">Total (Franc CFA)</mat-header-cell>
        <mat-cell *matCellDef="let row" class="total-column">{{row.totalAmount | currencyXof}}</mat-cell>
      </ng-container>

      <ng-container matColumnDef="actions">
        <mat-header-cell *matHeaderCellDef class="actions-column">Actions</mat-header-cell>
        <mat-cell *matCellDef="let element" class="actions-column">
          <button mat-icon-button color="warn" (click)="onDelete(element)"><mat-icon>delete_outline</mat-icon></button>
        </mat-cell>
      </ng-container>

      <!-- Table rows -->
      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; let i = index; columns: displayedColumns" [ngClass]="{'odd-row': i % 2 !== 0, 'even-row': i % 2 === 0}"></mat-row>
    </mat-table>
  </div>
  <div class="validation-container">
    <button mat-raised-button color="primary" (click)="onSave()">Sauvegarder</button>
  </div>
</div>
